{% extends "index/base.html" %}
{% block title %}Landing{% endblock %}
{% load static %}
{% block content %}

<form enctype='multipart/form-data' method="POST" action="" class="row g-3" id="shipping-form" e>
{% csrf_token %}
  <td>Select Pictures: </td>
  <input type="file" name="images" accept="image/*" multiple="" required="" id="id_image" class="form-control">
  <td><button type="submit"> Upload </button> </td>
</form>

<div class="infinite-container">
  {% for product in page_obj %}
  <div class="col infinite-item">
    <div class="card h-100">
      <img src="{% static product.image %}" width="100%" class="card-img-top">
      <div class="card-body">
        <h5 class="card-title">{{product.title}}</h5>
        <p class="card-text">{{product.description|truncatewords:25}}</p>
      </div>
      <div class="box-element product m-2">
        <a class="btn btn-outline-success" href="#">View</a>
        <a href={% url 'store:addtocart' product.title %} class="btn btn-outline-secondary add-btn">Add to Cart</a>
        <h4 style="display: inline-block; float: right"><strong>{{product.price|floatformat:2}}$</strong></h4>
      </div>
      <div class="card-footer">
        <small class="text-muted">{{product.category}}</small>
      </div>
    </div>
  </div>
  <div class="col infinite-item">
    <div class="card h-100">
      <img src="{% static product.image %}" width="100%" class="card-img-top">
      <div class="card-body">
        <h5 class="card-title">{{product.title}}</h5>
        <p class="card-text">{{product.description|truncatewords:25}}</p>
      </div>
      <div class="box-element product m-2">
        <a class="btn btn-outline-success" href="#">View</a>
        <a href={% url 'store:addtocart' product.title %} class="btn btn-outline-secondary add-btn">Add to Cart</a>
        <h4 style="display: inline-block; float: right"><strong>{{product.price|floatformat:2}}$</strong></h4>
      </div>
      <div class="card-footer">
        <small class="text-muted">{{product.category}}</small>
      </div>
    </div>
  </div>
  <div class="col infinite-item">
    <div class="card h-100">
      <img src="{% static product.image %}" width="100%" class="card-img-top">
      <div class="card-body">
        <h5 class="card-title">{{product.title}}</h5>
        <p class="card-text">{{product.description|truncatewords:25}}</p>
      </div>
      <div class="box-element product m-2">
        <a class="btn btn-outline-success" href="#">View</a>
        <a href={% url 'store:addtocart' product.title %} class="btn btn-outline-secondary add-btn">Add to Cart</a>
        <h4 style="display: inline-block; float: right"><strong>{{product.price|floatformat:2}}$</strong></h4>
      </div>
      <div class="card-footer">
        <small class="text-muted">{{product.category}}</small>
      </div>
    </div>
  </div>
  <div class="col infinite-item">
    <div class="card h-100">
      <img src="{% static product.image %}" width="100%" class="card-img-top">
      <div class="card-body">
        <h5 class="card-title">{{product.title}}</h5>
        <p class="card-text">{{product.description|truncatewords:25}}</p>
      </div>
      <div class="box-element product m-2">
        <a class="btn btn-outline-success" href="#">View</a>
        <a href={% url 'store:addtocart' product.title %} class="btn btn-outline-secondary add-btn">Add to Cart</a>
        <h4 style="display: inline-block; float: right"><strong>{{product.price|floatformat:2}}$</strong></h4>
      </div>
      <div class="card-footer">
        <small class="text-muted">{{product.category}}</small>
      </div>
    </div>
  </div>
  <div class="col infinite-item">
    <div class="card h-100">
      <img src="{% static product.image %}" width="100%" class="card-img-top">
      <div class="card-body">
        <h5 class="card-title">{{product.title}}</h5>
        <p class="card-text">{{product.description|truncatewords:25}}</p>
      </div>
      <div class="box-element product m-2">
        <a class="btn btn-outline-success" href="#">View</a>
        <a href={% url 'store:addtocart' product.title %} class="btn btn-outline-secondary add-btn">Add to Cart</a>
        <h4 style="display: inline-block; float: right"><strong>{{product.price|floatformat:2}}$</strong></h4>
      </div>
      <div class="card-footer">
        <small class="text-muted">{{product.category}}</small>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<div class="pagination">
  <span class="step-links">
    <!-- {% if page_obj.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ page_obj.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
        </span> -->

    {% if page_obj.has_next %}
    <a class="infinite-more-link" href="?page={{ page_obj.next_page_number }}">More</a>
    <!-- <a href="?page={{ page_obj.next_page_number }}">next</a> -->
    <!-- <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a> -->
    {% endif %}
  </span>
</div>

<div class="d-flex position-fixed loading d-none" style="top:35vh;left:46vw">
  <button class="btn ">
    <span class="spinner-border text-primary" id="spinner" role="status"></span>
  </button>
</div>


<script src={% static "js/jquery.waypoints.min.js" %}></script>
<script src={% static "js/infinite.min.js" %}></script>

<script>
  var loading = document.getElementsByClassName('loading')
  var infinite = new Waypoint.Infinite({
    element: $('.infinite-container')[0],
    offset: 'bottom-in-view',
    onBeforePageLoad: function () {
      $('.loading').removeClass('d-none');
    },
    onAfterPageLoad: function () {
      $('.loading').addClass('d-none');
    }
  });
</script>

{% endblock %}